{"version":3,"file":"before.decorator.js","sourceRoot":"","sources":["../../src/decorator/before.decorator.ts"],"names":[],"mappings":";;AAEA,0DAA6D;AAE7D;;;;;;;;;;;;;;;;;;;;;;;;;;;GA2BG;AACH,gBAAuB,MAAuC;IAC5D,MAAM,CAAC,UAAU,MAAW,EAAE,WAAgB,EAAE,KAAa;QAC3D,yCAAsB,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC;YACpC,MAAM,EAAE,MAAM;YACd,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,WAAW;YAChC,WAAW,EAAE,MAAM,IAAK,MAAuB,CAAC,WAAW,GAAI,MAAuB,CAAC,WAAW,GAAG,IAAI;YACzG,KAAK,EAAE,KAAK;YACZ,QAAQ,EAAE,WAAW;YACrB,UAAU,EAAE,MAAM,IAAK,MAAuB,CAAC,UAAU,GAAI,MAAuB,CAAC,UAAU,GAAG,MAA0B;SAC7H,CAAC,CAAC;IACL,CAAa,CAAC;AAChB,CAAC;AAXD,wBAWC","sourcesContent":["import { BeforeMiddleware } from '../middleware';\nimport { BeforeOption } from '../metadata';\nimport { getMetadataArgsStorage } from '../metadata-builder';\n\n/**\n * Adding ability to declarative override function resolution on schemas with an implementation analog to an express middleware.\n *\n * Usage example:\n * ```\n * let middleware: BeforeMiddleware = (context: any, args: { [key: string]: any }, next: (error?: Error, value?: any) => any): any => {\n *   if(context.user.role != 'any role') {\n *     // can use context and resolve/return value as `1000`, for example, regardless of what resolve function actually implements\n *     next(null, 1000);\n *   } else {\n *     // keeps regular resolution flow\n *     next();\n *   }\n * };\n *\n * ...\n *\n * class ObjType {\n *   @Field()\n *   @Before(middleware)\n *   myFunction(input: number): number {\n *     return input * 2;\n *   }\n * }\n *\n * ```\n * @param option Options for an Schema\n */\nexport function Before(option: BeforeOption | BeforeMiddleware) {\n  return function (target: any, propertyKey: any, index: number) {\n    getMetadataArgsStorage().befores.push({\n      target: target,\n      name: target.name || propertyKey,\n      description: option && (option as BeforeOption).description ? (option as BeforeOption).description : null,\n      index: index,\n      property: propertyKey,\n      middleware: option && (option as BeforeOption).middleware ? (option as BeforeOption).middleware : option as BeforeMiddleware,\n    });\n  } as Function;\n}\n"]}